<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Reese Locken">

<title>Data Mining Example</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Data Mining Demo_files/libs/clipboard/clipboard.min.js"></script>
<script src="Data Mining Demo_files/libs/quarto-html/quarto.js"></script>
<script src="Data Mining Demo_files/libs/quarto-html/popper.min.js"></script>
<script src="Data Mining Demo_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Data Mining Demo_files/libs/quarto-html/anchor.min.js"></script>
<link href="Data Mining Demo_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Data Mining Demo_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Data Mining Demo_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Data Mining Demo_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Data Mining Demo_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Mining Example</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Reese Locken </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The old saying goes: “There is no such thing as bad press.” I believe Boeing, Firestone, and Equifax would beg to differ, as would several of the entities in our data below.</p>
<p>In this data mining challenge, we will examine a dataset containing records of data breaches reported from 2004 to 2019. The breaches vary in size, type, and location.</p>
<p>We will clean and explore the dataset and use it to build a predictive model that business stakeholders can use to determine the potential impact of their own breach.</p>
</section>
<section id="understand-data" class="level1">
<h1>Understand Data</h1>
<p>First, we must learn the essence of the dataset and generate a few ideas about what it can be used for.</p>
<p>Let’s take a look:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(data, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 31%">
<col style="width: 5%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Entity</th>
<th style="text-align: left;">alternative name</th>
<th style="text-align: left;">records lost</th>
<th style="text-align: left;">YEAR</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">SECTOR</th>
<th style="text-align: left;">METHOD</th>
<th style="text-align: left;">interesting story</th>
<th style="text-align: left;">DATA SENSITIVITY</th>
<th style="text-align: left;">DISPLAYED RECORDS</th>
<th style="text-align: left;">…11</th>
<th style="text-align: left;">source name</th>
<th style="text-align: left;">1st source link</th>
<th style="text-align: left;">2nd source link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">year story broke</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>healthcare app retail gaming transport financial tech government telecoms legal media academic energy military |poor security hacked oops! lost device inside job |NA |1. Just email address/Online information 2 SSN/Personal details 3 Credit card information 4 Health &amp; other personal records 5 Full details |=IF(C3&gt;100000000,C3,“) |NA |NA |NA |NA |</p>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">colnames</span>(data), <span class="at">col.names =</span> <span class="st">'Column Names'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Column Names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Entity</td>
</tr>
<tr class="even">
<td style="text-align: left;">alternative name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">records lost</td>
</tr>
<tr class="even">
<td style="text-align: left;">YEAR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">story</td>
</tr>
<tr class="even">
<td style="text-align: left;">SECTOR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">METHOD</td>
</tr>
<tr class="even">
<td style="text-align: left;">interesting story</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DATA SENSITIVITY</td>
</tr>
<tr class="even">
<td style="text-align: left;">DISPLAYED RECORDS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">…11</td>
</tr>
<tr class="even">
<td style="text-align: left;">source name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1st source link</td>
</tr>
<tr class="even">
<td style="text-align: left;">2nd source link</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'The data has'</span>, <span class="fu">dim</span>(data)[<span class="dv">1</span>], <span class="st">'rows and'</span>, <span class="fu">dim</span>(data)[<span class="dv">2</span>], <span class="st">'columns.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The data has 340 rows and 14 columns.</code></pre>
</div>
</div>
<p>The data set appears to contain records of data breaches that have been reported on in the media. This could be useful to our organization in a few ways:</p>
<ul>
<li><p>We could examine breach patterns to see what we need to watch out for, especially in our own industry, with similar entities, and the types of data we are most obligated to protect.</p></li>
<li><p>We could identify the types of breaches that put us at the highest risk of becoming an “interesting story” (not the kind of press we’re looking for!).</p></li>
<li><p>We could select the reporting sources we should most closely watch to keep an eye on breach activity over time.</p></li>
</ul>
</section>
<section id="prepare-data" class="level1">
<h1>Prepare Data</h1>
<p>Before we can work with our data, we need to clean it. Let’s look through what we have and fix any issues we find.</p>
<p>The first row appears to contain data definitions. We will list these and remove them from our data set.</p>
<p><strong>Data Definitions</strong></p>
<p><em>YEAR</em>: year story broke</p>
<p><em>sector</em>: web, healthcare, app, retail, gaming, transport, financial, tech government, telecoms, legal, media, academic, energy, military</p>
<p><em>METHOD</em>: poor security, hacked, oops!, lost device, inside job</p>
<p><em>DATA SENSITIVITY</em>:</p>
<p>1. Just email address/Online information</p>
<p>2 SSN/Personal details</p>
<p>3 Credit card information</p>
<p>4 Health &amp; other personal records</p>
<p>5 Full details</p>
<p><em>DISPLAYED RECORDS</em>: If records lost is greater than 100 million, then that value appears in this column. Otherwise, it is blank.</p>
<p>Now we can remove that row.</p>
<p>cat(‘Rows remaining:’, rows_after_removal)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rows_before_removal <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> <span class="fu">pull</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>rows_after_removal <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> <span class="fu">pull</span>()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Rows removed:'</span>, rows_before_removal <span class="sc">-</span> rows_after_removal, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows removed: 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Rows remaining:'</span>, rows_after_removal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows remaining: 339</code></pre>
</div>
</div>
<p>Additionally, the eleventh column appears to be empty. Let’s confirm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Having confirmed that the eleventh column is empty, we will drop it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cols_before_removal <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(<span class="sc">-</span><span class="dv">11</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>cols_after_removal <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Columns removed:'</span>, cols_before_removal <span class="sc">-</span> cols_after_removal, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns removed: 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Columns remaining:'</span>, cols_after_removal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Columns remaining: 13</code></pre>
</div>
</div>
<p>Now let’s standardize the column names and make them easier to manipulate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>(data)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">colnames</span>(data), <span class="at">col.names =</span> <span class="st">'Column Names'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Column Names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">entity</td>
</tr>
<tr class="even">
<td style="text-align: left;">alternative_name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">records_lost</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">story</td>
</tr>
<tr class="even">
<td style="text-align: left;">sector</td>
</tr>
<tr class="odd">
<td style="text-align: left;">method</td>
</tr>
<tr class="even">
<td style="text-align: left;">interesting_story</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data_sensitivity</td>
</tr>
<tr class="even">
<td style="text-align: left;">displayed_records</td>
</tr>
<tr class="odd">
<td style="text-align: left;">source_name</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1st_source_link</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2nd_source_link</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>With standardized column names, we can now check for nulls and data quality issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(data)), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">'Column'</span>, <span class="st">'Null Count'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Column</th>
<th style="text-align: right;">Null Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">entity</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">alternative_name</td>
<td style="text-align: right;">203</td>
</tr>
<tr class="odd">
<td style="text-align: left;">records_lost</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">story</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sector</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">method</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">interesting_story</td>
<td style="text-align: right;">270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data_sensitivity</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">displayed_records</td>
<td style="text-align: right;">307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">source_name</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1st_source_link</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2nd_source_link</td>
<td style="text-align: right;">307</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Four columns have nulls for the majority of rows:</p>
<ul>
<li>alternative_name</li>
<li>interesting_story</li>
<li>displayed_records</li>
<li>x2nd_source_link</li>
</ul>
<p>Additionally, there is one missing row in records_lost. Let’s return to that.</p>
<p>In terms of null values, displayed_records is not a surprise, since it is explicitly programmed to only return a value when records_lost exceeds a certain value.</p>
<p>We will address those nulls in a moment. But first, let’s check out our data types and values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>column_info <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class) <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"data_type"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the column information</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(column_info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">column_name</th>
<th style="text-align: left;">data_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">entity</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">alternative_name</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">records_lost</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">story</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">sector</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">method</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">interesting_story</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">data_sensitivity</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">displayed_records</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">source_name</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1st_source_link</td>
<td style="text-align: left;">character</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2nd_source_link</td>
<td style="text-align: left;">character</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Everything is currently stored as a character. That seems appropriate for most values, but I expect the following should be different:</p>
<ul>
<li>records_lost =&gt; integer</li>
<li>year =&gt; time</li>
<li>interesting_story =&gt; factor</li>
<li>data_sensitivity =&gt; factor</li>
<li>displayed_records =&gt; integer</li>
</ul>
<p>Before changing these data types, let’s check if there are any inappropriate values that would prevent conversion.</p>
<p>We know that there is a null value in records_lost, so let’s start there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 59%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: left;">alternative_name</th>
<th style="text-align: left;">records_lost</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">interesting_story</th>
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: left;">displayed_records</th>
<th style="text-align: left;">source_name</th>
<th style="text-align: left;">x1st_source_link</th>
<th style="text-align: left;">x2nd_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OVH</td>
<td style="text-align: left;">French Internet host</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">Jul 2013. A hacker was able to obtain access to an email account of a system administrator, then to the internal VPN of another employee, with which they were able to compromise the access of one of the system administrators who handles the the internal backoffice.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">OVH</td>
<td style="text-align: left;">http://status.ovh.net/?do=details&amp;id=5070</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Upon visiting the provided link, the null appears to be valid. The report does not include any details on the number of records lost. We will keep this record unchanged.</p>
<p>What about records_lost?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check all unique values in records_lost</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(records_lost, <span class="st">"</span><span class="sc">\\</span><span class="st">D"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(records_lost) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(N)) <span class="sc">|&gt;</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">records_lost</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ALL</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">10M</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3M</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;3000000</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&lt;5000000</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>A few records contain values that cannot be converted easily to integers. Let’s address them one at a time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(records_lost <span class="sc">==</span> <span class="st">'ALL'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 48%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 17%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: left;">alternative_name</th>
<th style="text-align: left;">records_lost</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">interesting_story</th>
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: left;">displayed_records</th>
<th style="text-align: left;">source_name</th>
<th style="text-align: left;">x1st_source_link</th>
<th style="text-align: left;">x2nd_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animoto</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">ALL</td>
<td style="text-align: left;">2019</td>
<td style="text-align: left;">Feb 2019. Anomoto was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">app</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">CoffeeMeetsBagel</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">ALL</td>
<td style="text-align: left;">2019</td>
<td style="text-align: left;">Feb 2019. CoffeeMeetsBagel was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Petflow</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">ALL</td>
<td style="text-align: left;">2019</td>
<td style="text-align: left;">Feb 2019. Petflow was part of the theft of 127 million records from eight websites, by the same hacker who previously stole 617 million online account details from 16 other sites. All were put up for sale on the dark web.</td>
<td style="text-align: left;">retail</td>
<td style="text-align: left;">poor security</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Techcrunch</td>
<td style="text-align: left;">https://techcrunch.com/2019/02/14/hacker-strikes-again/</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For the “ALL” values, the text of the articles contains the counts we need:</p>
<ul>
<li><p>Animoto - 25 million</p></li>
<li><p>CoffeeMeetsBagel - 6 million</p></li>
<li><p>Petflow - 1 million</p></li>
</ul>
<p>We’ll replace “ALL” with those values later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(records_lost <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"&lt;3000000"</span>, <span class="st">"&lt;5000000"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 40%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 21%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: left;">alternative_name</th>
<th style="text-align: left;">records_lost</th>
<th style="text-align: left;">year</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">interesting_story</th>
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: left;">displayed_records</th>
<th style="text-align: left;">source_name</th>
<th style="text-align: left;">x1st_source_link</th>
<th style="text-align: left;">x2nd_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Saks and Lord &amp; Taylor</td>
<td style="text-align: left;">Both owned by Hudson’s Bay Company</td>
<td style="text-align: left;">&lt;5000000</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">Apr 2018. A known ring of cybercriminals implanted software into store cash registers, siphoning off payment card details. The company has not divulged the full extent of the breach. Researchers estimate 5m records.</td>
<td style="text-align: left;">retail</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NYTimes</td>
<td style="text-align: left;">https://www.nytimes.com/2018/04/01/technology/saks-lord-taylor-credit-cards.html</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Health South East</td>
<td style="text-align: left;">Health authority responsible for 10 Norwegian counties.</td>
<td style="text-align: left;">&lt;3000000</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">Feb 2018. Health data was stolen from more than half of Norway’s population.</td>
<td style="text-align: left;">healthcare</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">It Governance</td>
<td style="text-align: left;">https://www.itgovernance.eu/blog/en/breach-at-norways-largest-healthcare-authority-was-a-disaster-waiting-to-happen</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These articles do not contain values we can impute. However, based on the fact that “up to” estimates are often near the true value (e.g.&nbsp;you say “we’re in the top 10” if you’re ranked ninth, not “we’re in the top 20”), I think it is safe to impute the values provided minus one.</p>
<p>Thus, we can now replace our text values with integers and change the data type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>num_rows_to_change <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(records_lost, <span class="st">"</span><span class="sc">\\</span><span class="st">D"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">records_lost =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                (records_lost <span class="sc">==</span> <span class="st">'ALL'</span> <span class="sc">&amp;</span> entity <span class="sc">==</span> <span class="st">'Animoto'</span>) <span class="sc">~</span> <span class="dv">25000000</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                (records_lost <span class="sc">==</span> <span class="st">'ALL'</span> <span class="sc">&amp;</span> entity <span class="sc">==</span> <span class="st">'CoffeeMeetsBagel'</span>) <span class="sc">~</span> <span class="dv">6000000</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                (records_lost <span class="sc">==</span> <span class="st">'ALL'</span> <span class="sc">&amp;</span> entity <span class="sc">==</span> <span class="st">'Petflow'</span>) <span class="sc">~</span> <span class="dv">1000000</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                records_lost <span class="sc">==</span> <span class="st">'10M'</span> <span class="sc">~</span> <span class="dv">10000000</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                records_lost <span class="sc">==</span> <span class="st">'3M'</span> <span class="sc">~</span> <span class="dv">3000000</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                records_lost <span class="sc">==</span> <span class="st">'&lt;5000000'</span> <span class="sc">~</span> <span class="dv">5000000</span> <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                records_lost <span class="sc">==</span> <span class="st">'&lt;3000000'</span> <span class="sc">~</span> <span class="dv">3000000</span> <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.integer</span>(records_lost)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>              ))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Rows affected:'</span>, num_rows_to_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows affected: 8</code></pre>
</div>
</div>
<p>Next, let’s check our year variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">year</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1999</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2004</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2005</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">2006</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2007</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">2008</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2009</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">2010</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2011</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">2012</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2013</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">2014</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2015</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">2016</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2017</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">2018</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2019</td>
<td style="text-align: right;">33</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are no problematic values here, so we can change it to a date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(<span class="fu">ymd</span>(<span class="fu">paste0</span>(year, <span class="st">"-01-01"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s handle interesting_story next. We can replace the current variables with more descriptive ones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(interesting_story) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">interesting_story</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">270</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">interesting_story =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(interesting_story), </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">'No'</span>, <span class="st">'Yes'</span>), </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'No'</span>, <span class="st">'Yes'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>data_sensitivity has an unexpected value. Let’s investigate before converting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_sensitivity) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">108</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(data_sensitivity <span class="sc">==</span> <span class="st">'7'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 38%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 22%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: left;">alternative_name</th>
<th style="text-align: right;">records_lost</th>
<th style="text-align: right;">year</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">interesting_story</th>
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: left;">displayed_records</th>
<th style="text-align: left;">source_name</th>
<th style="text-align: left;">x1st_source_link</th>
<th style="text-align: left;">x2nd_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Animoto</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2.5e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Anomoto was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">app</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x1st_source_link <span class="sc">==</span> <span class="st">'https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 38%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 21%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: left;">alternative_name</th>
<th style="text-align: right;">records_lost</th>
<th style="text-align: right;">year</th>
<th style="text-align: left;">story</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">interesting_story</th>
<th style="text-align: left;">data_sensitivity</th>
<th style="text-align: left;">displayed_records</th>
<th style="text-align: left;">source_name</th>
<th style="text-align: left;">x1st_source_link</th>
<th style="text-align: left;">x2nd_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dubsmash</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1.62e+08</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Dubsmash was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">app</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">162000000</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">ShareThis</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">4.10e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. ShareThis was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HauteLook</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2.80e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. HauteLook was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">retail</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Animoto</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2.50e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Anomoto was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">app</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EyeEm</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2.20e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. EyeEm was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">8fit</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2.00e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. 8fit was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">app</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Whitepages</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1.80e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Whitepages was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fotolog</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3.00e+06</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Fotolog was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Armor Games</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1.10e+07</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Armor Games was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">gaming</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">BookMate</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">8.00e+06</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. BookMate was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CoffeeMeetsBagel</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6.00e+06</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. CoffeeMeetsBagel was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Artsy</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">1.00e+06</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. Artsy was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DataCamp</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">7.00e+05</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Feb 2019. DataCamp was part of the theft of 617 million online account details from 16 hacked websites, put up for sale on the dark web.</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">hacked</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">The Register</td>
<td style="text-align: left;">https://www.theregister.co.uk/2019/02/11/620_million_hacked_accounts_dark_web/</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All other breaches from that same source have data_sensitivity = 1. So we will change the 7 to 1 for this record.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>num_rows_change <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(data_sensitivity <span class="sc">==</span> <span class="st">'7'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">pull</span>()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">data_sensitivity =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(data_sensitivity <span class="sc">==</span> <span class="st">'7'</span>, <span class="dv">1</span>, </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                                    data_sensitivity),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>, <span class="st">'5'</span>)))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Rows affected:'</span>, num_rows_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows affected: 1</code></pre>
</div>
</div>
<p>Finally, because displayed_records is based on a rule, we can simply re-create the rule to populate the column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">displayed_records =</span> <span class="fu">ifelse</span>(records_lost <span class="sc">&gt;</span> <span class="dv">100000000</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                                            records_lost, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s clean up the other columns. I have removed some of my exploratory code, but the process for each column was the same: I harmonized similar values under one category (e.g.&nbsp;Snapchat) and checked article links to determine appropriate categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean entity</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">gsub</span>(<span class="st">'"'</span>,<span class="st">''</span>, entity)) <span class="sc">|&gt;</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">gsub</span>(<span class="st">'Snapchat'</span>, <span class="st">'SnapChat'</span>, entity)) <span class="sc">|&gt;</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">ifelse</span>(entity <span class="sc">==</span> <span class="st">'US Office of Personnel Management (2nd Breach)'</span>, <span class="st">'US Office of Personnel Management'</span>, entity)) <span class="sc">|&gt;</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>          <span class="co"># This record appears to be a duplicate of the LinkedIn and Last.fm breaches, with no data about eHarmony's count of lost passwords</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(entity <span class="sc">!=</span> <span class="st">'LinkedIn, eHarmony, Last.fm'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean story</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This is a duplicate story, with a less accurate count of lost documents</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># I have retained the other record and credited the story to The Guardian</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(alternative_name <span class="sc">!=</span> <span class="st">'Wikileaks / Bradley Manning/Cablegate.'</span> <span class="sc">|</span> <span class="fu">is.na</span>(alternative_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">==</span> <span class="st">'Guardian, Wikileaks'</span>, <span class="st">'Guardian'</span>, source_name))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean source_name</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># If there were two listed sources, I chose to credit the first listed source</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co"># One could also split the source_name column into two: source_1 and source_2</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">==</span> <span class="st">'Guardian'</span>, <span class="st">'The Guardian'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">==</span> <span class="st">'ZD Net'</span>, <span class="st">'ZDNet'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">==</span> <span class="st">'Washington-Post'</span>, <span class="st">'Washington Post'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'NY Times'</span>, <span class="st">'NY Times, Gov Tech'</span>), <span class="st">'NYTimes'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Wired, CBNC'</span>, <span class="st">'Wired, Digital Trends'</span>), <span class="st">'Wired'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Naked Security, NBC News'</span>, <span class="st">'Naked Security, New York Times'</span>), <span class="st">'NYTimes'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Computer World, Hacker News'</span>), <span class="st">'Computer World'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Korea Times, CNet'</span>), <span class="st">'Korea Times'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'NBC29'</span>), <span class="st">'NBC'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Reuters, Privacy Rights'</span>), <span class="st">'Reuters'</span>, source_name)) <span class="sc">|&gt;</span> </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">ifelse</span>(source_name <span class="sc">==</span> <span class="st">'GCN, US Gov'</span>, <span class="st">'GCN'</span>, source_name))</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean sector</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate smaller sectors to their most logical parent</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'government, military'</span>, <span class="st">'government'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'government, healthcare'</span>, <span class="st">'government'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'military, healthcare'</span>, <span class="st">'healthcare'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'web, military'</span>, <span class="st">'web'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'web, gaming'</span>, <span class="st">'web'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'tech, app'</span>, <span class="st">'tech'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'web, tech'</span>, <span class="st">'tech'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'tech, retail'</span>, <span class="st">'retail'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'tech, web'</span>, <span class="st">'web'</span>, sector)) <span class="sc">|&gt;</span> </span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector =</span> <span class="fu">ifelse</span>(sector <span class="sc">==</span> <span class="st">'legal'</span>, <span class="st">'financial'</span>, sector))</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean year</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Per the article, the breach is actually from 2019</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">1999</span>, <span class="dv">2019</span>, year))</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'Cleaned data contains'</span>, <span class="fu">dim</span>(data)[<span class="dv">1</span>], <span class="st">'rows and'</span>, <span class="fu">dim</span>(data)[<span class="dv">2</span>], <span class="st">'columns.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cleaned data contains 337 rows and 13 columns.</code></pre>
</div>
</div>
</section>
<section id="explore-data" class="level1">
<h1>Explore Data</h1>
<p>Now that our data has been cleaned, we can begin exploring it. We can check univariate and bivariate distributions to look for patterns which can guide the product we end up creating.</p>
<p>Let’s start asking questions of our data!</p>
<p><strong>What is the distribution of records_lost?</strong></p>
<p>Records_lost appears to follow a power distribution. We can see that the distribution normalizes nicely when log transformed. Despite a slight uptick towards the extreme high numbers, checking the articles confirms that the counts are correct.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> records_lost)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">'lightpink'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">bins =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Distribution of Records Lost in Breaches'</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="sc">~</span> <span class="fu">format</span>(.x, <span class="at">scientific =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(records_lost <span class="sc">&lt;</span> <span class="dv">10000000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> records_lost)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">'lightpink'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Distribution of Records Lost in Breaches - Under 10M Records'</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_hist-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(records_lost))) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">'lightgrey'</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Log-Transformed Distribution of Records Lost'</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="sc">~</span> <span class="fu">format</span>(.x, <span class="at">scientific =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_hist-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(records_lost)) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(entity, records_lost, sector, x1st_source_link) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: right;">records_lost</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">x1st_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">River City Media</td>
<td style="text-align: right;">1.37e+09</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">https://www.theguardian.com/technology/2017/mar/06/email-addresses-spam-leak-river-city-media</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aadhaar</td>
<td style="text-align: right;">1.10e+09</td>
<td style="text-align: left;">government</td>
<td style="text-align: left;">http://www.zdnet.com/article/another-data-leak-hits-india-aadhaar-biometric-database/</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aadhaar</td>
<td style="text-align: right;">1.00e+09</td>
<td style="text-align: left;">government</td>
<td style="text-align: left;">https://www.theguardian.com/world/2018/jan/04/india-national-id-database-data-leak-bought-online-aadhaar</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yahoo</td>
<td style="text-align: right;">1.00e+09</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">http://www.nytimes.com/2016/12/14/technology/yahoo-hack.html?action=Click&amp;contentCollection=BreakingNews&amp;contentID=64651831&amp;pgtype=Homepage&amp;_r=0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">First American Financial Corporation</td>
<td style="text-align: right;">8.85e+08</td>
<td style="text-align: left;">financial</td>
<td style="text-align: left;">https://krebsonsecurity.com/2019/05/first-american-financial-corp-leaked-hundreds-of-millions-of-title-insurance-records/</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(entity, records_lost, sector, x1st_source_link) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">entity</th>
<th style="text-align: right;">records_lost</th>
<th style="text-align: left;">sector</th>
<th style="text-align: left;">x1st_source_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">uTorrent</td>
<td style="text-align: right;">35000</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">https://torrentfreak.com/utorrent-forums-hacked-passwords-compromised-160608/</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quest Diagnostics</td>
<td style="text-align: right;">34000</td>
<td style="text-align: left;">healthcare</td>
<td style="text-align: left;">http://newsroom.questdiagnostics.com/2016-12-12-Quest-Diagnostics-Provides-Notice-of-Data-Security-Incident#assets_129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Morgan Stanley Smith Barney</td>
<td style="text-align: right;">34000</td>
<td style="text-align: left;">financial</td>
<td style="text-align: left;">https://abcnews.go.com/Business/morgan-stanley-smith-barney-breach-losing-client-data/story?id=14008632</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wendy’s</td>
<td style="text-align: right;">1025</td>
<td style="text-align: left;">retail</td>
<td style="text-align: left;">https://www.forbes.com/sites/moneybuilder/2016/07/08/this-week-in-credit-card-news-wendys-data-breach-affects-1000-stores-card-fraud-dropping/#260a2f727bab</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OVH</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">web</td>
<td style="text-align: left;">http://status.ovh.net/?do=details&amp;id=5070</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, at the low end following the link for Wendy’s indicates that 1,025 locations were exposed.</p>
<p>Taking the average annual gross sales of <a href="https://www.franchisechatter.com/2023/03/10/fdd-talk-wendys-franchise-costs-fees-average-revenues-and-or-profits-2023-review/">$1,892,827</a> and assuming an average order size of $15, that gives us an average of about 10k customers per month. Assuming 50% are repeat customers and that the exposure lasted for three months, I will impute 20k customers per store, giving us an exposure of 20,500,000. This makes sense, as the article references a breach at Target that exposed 30 million customer records as a comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute estimate of records_lost for Wendy's</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">records_lost =</span> <span class="fu">ifelse</span>(entity <span class="sc">==</span> <span class="st">"Wendy's"</span>, <span class="dv">20500000</span>, records_lost))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Have the number of breaches changed over time?</strong></p>
<p>We see that breaches (or at least the reporting of breaches), has steadily increased. There is decent fluctuation from year-to-year, which might reflect ad-hoc reporting rather than true fluctuations in breach rates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> N)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'red'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Number of Breaches Reported Over Time'</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/breaches_over_time-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Have the number of records lost changed over time?</strong></p>
<p>Lost records follows a similar trend to breaches, with 2018 being a particularly bad year. However, stories for 2019 only appear to reach June 2019, so it’s likely our dataset cuts off at that point and 2019 actually had as many or more lost records than 2018.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">records =</span> <span class="fu">sum</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> records)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'orange'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Number of Records Lost Over Time'</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_over_time-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">extracted_month =</span> <span class="fu">str_extract</span>(story, <span class="st">"^[^.]*"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(extracted_month) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">extracted_month</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">June 2019</td>
</tr>
<tr class="even">
<td style="text-align: left;">May 2019</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apr 2019</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mar 2019</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Feb 2019</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jan 2019</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>How has the average size of a breach changed over time?</strong></p>
<p>Interestingly, our average breach size does not show the same linear growth pattern. Perhaps large breaches take longer to organize, and thus don’t occur at annual intervals?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">size =</span> <span class="fu">sum</span>(records_lost) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> size)) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'purple'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Average Breach Size Over Time'</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/avg_breach_size-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we look at the largest breaches, we find that in fact they are not evenly distributed. The number of large breaches has increased over time. So not only are we getting more breaches, we are seeing larger ones on average and more very large ones. This is bad news!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">large_breach =</span> <span class="fu">ifelse</span>(records_lost <span class="sc">&gt;</span> <span class="dv">76000000</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">large_breaches =</span> <span class="fu">sum</span>(large_breach)) <span class="sc">|&gt;</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> large_breaches)) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'cyan'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Count of Breaches in Top 10%'</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/large_breaches-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Have certain methods become more popular?</strong></p>
<p>We see that the largest increases in breaches have come from hacks and poor security. This has business implications: perhaps we should rethink our current level of investment in cybersecurity?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colorblind palette</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Breaches by method over time</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(interesting_story == 'Yes') |&gt; </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, method) <span class="sc">|&gt;</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> N, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cbPalette) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Breach Methods Over Time - Breach Count'</span>) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/methods_over_time-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Records lost by method over time</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span>  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, method) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">sum</span>(records_lost), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> N, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cbPalette) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">round</span>(x <span class="sc">/</span> <span class="fl">1e6</span>, <span class="dv">1</span>), <span class="st">"M"</span>)) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Breach Methods Over Time - Records Lost'</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/methods_over_time-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Who are the biggest breach victims?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(entity) <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(N <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N) <span class="sc">|&gt;</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">factor</span>(entity, <span class="at">levels =</span> <span class="fu">unique</span>(entity))) <span class="sc">|&gt;</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> N, <span class="at">y =</span> entity)) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'lightblue'</span>, <span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Repeat Breach Victims'</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'# Breaches'</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/breach_victims-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="interesting-stories---a-pr-nightmare" class="level2">
<h2 class="anchored" data-anchor-id="interesting-stories---a-pr-nightmare">Interesting Stories - A PR Nightmare?</h2>
<p>Certain breaches have been classified as “interesting stories”. Presumably, this kind of story is more likely to get picked up and shared, resulting in bad press for our organization. As such, they are best avoided. Let’s see what we can learn about the characteristics of these stories to make sure we don’t become one.</p>
<p><strong>Does the size of the breach correlate with interesting_story?</strong></p>
<p>In the raw data chart, it appears that interesting stories have more large-loss breaches. However, the y-axis has been cut off to keep the inter-quartile range readable. When log-transformed, we see that the distributions are much more similar. A Mann-Whitney U test fails to find a statistically significant difference, reinforcing the notion that there is not much difference between these groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> interesting_story, <span class="at">y =</span> records_lost, <span class="at">fill =</span> interesting_story)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">10000000</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Distribution of Records Lost in Breach'</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">round</span>(x <span class="sc">/</span> <span class="fl">1e6</span>, <span class="dv">1</span>), <span class="st">"M"</span>)) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_vs_interesting_story-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> interesting_story, <span class="at">y =</span> <span class="fu">log</span>(records_lost), <span class="at">fill =</span> interesting_story)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(0,10000000) +</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Log Distribution of Records Lost in Breach'</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/records_lost_vs_interesting_story-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct Mann-Whitney U test to identify whether the difference is significant</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(records_lost) <span class="sc">|&gt;</span> <span class="fu">pull</span>()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(interesting_story <span class="sc">==</span> <span class="st">'No'</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(records_lost) <span class="sc">|&gt;</span> <span class="fu">pull</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Conducting the Mann-Whitney U test</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(group1, group2, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the test results</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  group1 and group2
W = 8864, p-value = 0.7294
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p><strong>Does the source correlate with interesting_story?</strong></p>
<p>The Guardian has the highest success rate, (7% of stories are interesting) and The Register does not have a single interesting story despite a relatively high number of publications (14).</p>
<p>Still, no strong pattern emerges that certain publications are more likely to have interesting stories. So sending a box of cigars to the chief editor of Wired isn’t going to cut it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table with interesting story counts by source</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(interesting_story,source_name) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> interesting_story, <span class="at">values_from =</span> N) <span class="sc">|&gt;</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">No =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(No), <span class="dv">0</span>, No),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Yes =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Yes), <span class="dv">0</span>, Yes),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> No <span class="sc">+</span> Yes,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_sig =</span> Yes <span class="sc">/</span> total) <span class="sc">|&gt;</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Yes)) <span class="sc">|&gt;</span> </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">source_name</th>
<th style="text-align: right;">No</th>
<th style="text-align: right;">Yes</th>
<th style="text-align: right;">total</th>
<th style="text-align: right;">pct_sig</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">The Guardian</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.2083333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Computer World</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.7500000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BBC News</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.1538462</td>
</tr>
<tr class="even">
<td style="text-align: left;">Business Insider</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.4000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CNN</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.3333333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Computer Weekly</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.4000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Krebs on Security</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.3333333</td>
</tr>
<tr class="even">
<td style="text-align: left;">NYTimes</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.2000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reuters</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.1818182</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tech Crunch</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.4000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Washington Post</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.4000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wired</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.3333333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Info Watch</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mashable</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABC News</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.2500000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ars Technica</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CNET</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">CNet</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dark Reading</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Data Breaches</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.1111111</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize counts for all sources with at least one story</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to sources with at least one interesting story</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>interesting_sources <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source_name) <span class="sc">|&gt;</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">pull</span>()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to sources with more than one story total</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>multiple_stories <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source_name) <span class="sc">|&gt;</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(N <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source_name) <span class="sc">|&gt;</span> </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source_name <span class="sc">%in%</span> interesting_sources) <span class="sc">|&gt;</span> </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source_name <span class="sc">%in%</span> multiple_stories) <span class="sc">|&gt;</span> </span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source_name) <span class="sc">|&gt;</span> </span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(N)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder source_name factor levels</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>data_filtered<span class="sc">$</span>source_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_filtered<span class="sc">$</span>source_name, <span class="at">levels =</span> data_filtered<span class="sc">$</span>source_name)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge back the filtered data with the reordered factor levels</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>data_reordered <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source_name <span class="sc">%in%</span> interesting_sources) <span class="sc">|&gt;</span> </span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source_name <span class="sc">%in%</span> multiple_stories) <span class="sc">|&gt;</span> </span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source_name =</span> <span class="fu">factor</span>(source_name, <span class="at">levels =</span> <span class="fu">levels</span>(data_filtered<span class="sc">$</span>source_name)))</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_reordered, <span class="fu">aes</span>(<span class="at">y =</span> source_name, <span class="at">fill =</span> interesting_story)) <span class="sc">+</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Count"</span>, <span class="at">y =</span> <span class="st">"Source Name"</span>, <span class="at">fill =</span> <span class="st">"Interesting Story"</span>) <span class="sc">+</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette) <span class="sc">+</span></span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Stories by Source'</span>) <span class="sc">+</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/source_vs_interesting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize relationship between interesting and not interesting story counts</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(interesting_story,source_name) <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> interesting_story, <span class="at">values_from =</span> N) <span class="sc">|&gt;</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">No =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(No), <span class="dv">0</span>, No),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Yes =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Yes), <span class="dv">0</span>, Yes),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> No <span class="sc">+</span> Yes,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_interesting =</span> Yes <span class="sc">/</span> Total) <span class="sc">|&gt;</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> No, <span class="at">y =</span> Yes)) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">'darkblue'</span>) <span class="sc">+</span>   </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Not Interesting vs. Interesting Stories by Publication'</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Not Interesting'</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Interesting'</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/source_vs_interesting-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get table showing proportion of all interesting stories by source</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source_name) <span class="sc">|&gt;</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> N <span class="sc">/</span> <span class="fu">sum</span>(N)) <span class="sc">|&gt;</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop)) <span class="sc">|&gt;</span> </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">source_name</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">prop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">The Guardian</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0735294</td>
</tr>
<tr class="even">
<td style="text-align: left;">Computer World</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0441176</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BBC News</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Business Insider</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CNN</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Computer Weekly</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Info Watch</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Krebs on Security</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mashable</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">NYTimes</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reuters</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tech Crunch</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Washington Post</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wired</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.0294118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABC News</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adobe</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alphr</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ars Technica</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boing Boing, Wired</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">CNET</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CNet</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">ComputerSweden</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dark Reading</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Data Breaches</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deal Book</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Digital Health</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flanders Today</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fosters</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Guelph Mercury</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Health IT Security</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Huffington Post</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Motherboard</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">NBC</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NBC News</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">NetworkWorld</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PC World</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">PanamaPapers</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Proskauer</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Salt Lake Tribune</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Security Week</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Softpedia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Techcrunch</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">Technology Review</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Intercept</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Local</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Next Web</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">UK Gov</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wall Street Journal</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
<tr class="even">
<td style="text-align: left;">ZDNet</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0147059</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Does the method of the breach correlate with interesting_story?</strong></p>
<p>Lost devices and oops! are over-represented as interesting stories. Perhaps because accidents like these stand out?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prop_interesting =</span> <span class="fu">mean</span>(<span class="fu">ifelse</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> prop_interesting, <span class="at">fill =</span> method)) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> N), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Proportion of Interesting Stories by Method'</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Method'</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Proportion of Stories Rated Interesting'</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/method_vs_interesting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Does the data sensitivity correlate with interesting_story?</strong></p>
<p>Data breaches that involve social security numbers, financial information, or all information are more likely to be rated as interesting. This is understandable, as the immediate consequences for consumers are greater.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_sensitivity) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prop_interesting =</span> <span class="fu">mean</span>(<span class="fu">ifelse</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> data_sensitivity, <span class="at">y =</span> prop_interesting, <span class="at">fill =</span> data_sensitivity)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> N), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Proportion of Interesting Stories by Data Sensistivity'</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Data Sensitivity'</span>,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'Proportion of Stories Rated Interesting'</span>) <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Just email'</span>, <span class="st">'Personal details'</span>,<span class="st">'Credit card'</span>, </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>                              <span class="st">'Health'</span>, <span class="st">'Full details'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/sensitivity_vs_interesting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Does the data sensitivity correlate with method?</strong></p>
<p>We see that hacks are most likely to obtain online information or personal details. This makes sense, as those are the fields most likely to be stored in a public-facing website.</p>
<p>The risk of full details being disclosed is highest from an inside job. This is also reasonable, because access to an internal database exposes much more data. When combined with the proportion of full-detail disclosures that are rated as interesting stories, we should review that internal data is locked down. Users should not be able to remove data from the system, either digitally or via external devices.</p>
<p>Fisher’s exact test allows us to reject the null hypothesis at alpha = 0.05 and conclude that there is an association between the method used and the sensitivity of the data exposed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by and summarize, then calculate the proportions</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method, data_sensitivity) <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">|&gt;</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> N <span class="sc">/</span> <span class="fu">sum</span>(N))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the 100% stacked column chart</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_normalized, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Proportion, </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> data_sensitivity)) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Method"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Data Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Just email'</span>, </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">'Personal details'</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">'Credit card'</span>, <span class="st">'Health'</span>, </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">'Full details'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/sensitivity_vs_method-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher's exact test</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data_sensitivity, method) <span class="sc">|&gt;</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> data_sensitivity, <span class="at">values_from =</span> N, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">N =</span> <span class="dv">0</span>))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>contingency_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(contingency_table[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(contingency_matrix) <span class="ot">&lt;-</span> contingency_table<span class="sc">$</span>interesting_story</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Fisher's exact test</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(contingency_matrix, <span class="at">workspace =</span> <span class="fl">2e8</span>, </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the Fisher's test result</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data with simulated p-value (based on
    2000 replicates)

data:  contingency_matrix
p-value = 0.0004998
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p><strong>Does the sector correlate with interesting_story?</strong></p>
<p>The financial sector and telecoms have the highest proportions of interesting stories for sectors with at least 5 stories. I suspect these sectors are likely to have very large breaches. Let’s check that next.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">|&gt;</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">prop_interesting =</span> <span class="fu">mean</span>(<span class="fu">ifelse</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(N <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sector, <span class="at">y =</span> prop_interesting, <span class="at">fill =</span> sector)) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> N), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = cbPalette) +</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Proportion of Interesting Stories by Sector'</span>) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/sector_vs_interesting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>What is the size of the breach across sectors?</strong></p>
<p>The breach size does not appear to be the driving factor in the prominence of the financial and telecoms sectors. On second thought, this makes sense. Our Mann-Whitney U test did not show a significant difference in the distributions of records lost in the “Interesting” vs.&nbsp;“Not Interesting” story groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sector, <span class="at">y =</span> records_lost, <span class="at">fill =</span> sector)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1000000</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = cbPalette) +</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Records Lost by Sector'</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>),</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">'none'</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/breach_size_by_sector-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Perhaps it is the type of information lost or the method that makes these sectors prominent?</strong></p>
<p>We are getting a bit more complicated here, with more variables here than we can easily visualize.</p>
<p>Let’s build a logistic model to try to quantify the relationship. Because we don’t have a lot of data to work with, I will select the variables I expect to have the highest correlations and dichotomize sector into finance/telecom vs.&nbsp;other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">finance_telecom =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(sector <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'financial'</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                                                               <span class="st">'telecoms'</span>), </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">'Yes'</span>, <span class="st">'No'</span>), </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'No'</span>, <span class="st">'Yes'</span>)))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>interestingModel_inference <span class="ot">&lt;-</span> <span class="fu">glm</span>(interesting_story <span class="sc">~</span> finance_telecom <span class="sc">+</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                                    data_sensitivity <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                                   records_lost,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)),</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(interestingModel_inference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = interesting_story ~ finance_telecom + data_sensitivity + 
    records_lost, family = "binomial", data = filter(data, !is.na(records_lost)))

Coefficients:
                          Estimate      Std. Error z value        Pr(&gt;|z|)    
(Intercept)        -1.957159988416  0.296200769892  -6.608 0.0000000000391 ***
finance_telecomYes  1.053348513744  0.343537392300   3.066        0.002168 ** 
data_sensitivity2   0.607134719244  0.374773909380   1.620        0.105232    
data_sensitivity3   0.390024384502  0.456512871155   0.854        0.392908    
data_sensitivity4   0.095840823498  0.479562888597   0.200        0.841598    
data_sensitivity5   1.746080893252  0.504408519020   3.462        0.000537 ***
records_lost       -0.000000002031  0.000000001933  -1.051        0.293280    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 338.48  on 335  degrees of freedom
Residual deviance: 312.65  on 329  degrees of freedom
AIC: 326.65

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pseudo R-squared to check model fit - higher is better</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>logisticPseudoR2s <span class="ot">&lt;-</span> <span class="cf">function</span>(LogModel) {</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  dev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>deviance</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  nullDev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>null.deviance</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  modelN <span class="ot">&lt;-</span> <span class="fu">length</span>(LogModel<span class="sc">$</span>fitted.values)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  R.l <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> dev <span class="sc">/</span> nullDev</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  R.cs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>( <span class="sc">-</span>(nullDev <span class="sc">-</span> dev) <span class="sc">/</span> modelN)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  R.n <span class="ot">&lt;-</span> R.cs <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">exp</span> (<span class="sc">-</span>(nullDev <span class="sc">/</span> modelN))))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'Pseudo R-squared for logistic regression</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'Hosmer/Lemeshow:'</span>, <span class="fu">round</span>(R.l, <span class="dv">3</span>), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'Cox &amp; Snell:'</span>, <span class="fu">round</span>(R.cs, <span class="dv">3</span>), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'Nagelkerke:'</span>, <span class="fu">round</span>(R.n, <span class="dv">3</span>), <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="fu">logisticPseudoR2s</span>(interestingModel_inference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R-squared for logistic regression
Hosmer/Lemeshow: 0.076 
Cox &amp; Snell: 0.074 
Nagelkerke: 0.117 </code></pre>
</div>
</div>
<p>It appears that even when controlling for data sensitivity and records lost the financial and telecom industries are over-represented in the “interesting stories” category. Perhaps this is related to the relative prominence of these industries in publications.</p>
<p>The code for checking the validity of the model can be found in the appendix.</p>
</section>
</section>
<section id="ds-technique" class="level1">
<h1>DS Technique</h1>
<p>Now that we have a sense of the relationship between our variables and whether a story is interesting or not, let’s build two models to predict the likelihood of a breach being noted as interesting. First, we will adjust our linear model to be suitable for prediction. Then, we will compare its performance to a random forest model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic model</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">&lt;-</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'glm'</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>log_wflow <span class="ot">&lt;-</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_formula</span>(</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    interesting_story <span class="sc">~</span> sector <span class="sc">+</span> method <span class="sc">+</span> data_sensitivity <span class="sc">+</span> records_lost) <span class="sc">|&gt;</span> </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_model)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span>  </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  log_wflow <span class="sc">|&gt;</span> </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)))</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Random forest model</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rand_forest</span>(<span class="at">trees =</span> <span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'ranger'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">'classification'</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>rf_wflow <span class="ot">&lt;-</span> </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_formula</span>(</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    interesting_story <span class="sc">~</span> sector <span class="sc">+</span> method <span class="sc">+</span> data_sensitivity <span class="sc">+</span> records_lost</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_model)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>rf_fit <span class="ot">&lt;-</span> rf_wflow <span class="sc">|&gt;</span> </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)))</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6501</span>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>data_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)), <span class="at">v =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">5</span>)</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>keep_pred <span class="ot">&lt;-</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>, <span class="at">save_workflow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>log_res <span class="ot">&lt;-</span> </span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>  log_wflow <span class="sc">|&gt;</span> </span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(log_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  .metric     .estimator  mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.792    50 0.0114  Preprocessor1_Model1
2 brier_class binary     0.162    50 0.00727 Preprocessor1_Model1
3 roc_auc     binary     0.654    50 0.0203  Preprocessor1_Model1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>rf_res <span class="ot">&lt;-</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  rf_wflow <span class="sc">|&gt;</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> data_folds, <span class="at">control =</span> keep_pred)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(rf_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  .metric     .estimator  mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.784    50 0.00975 Preprocessor1_Model1
2 brier_class binary     0.164    50 0.00598 Preprocessor1_Model1
3 roc_auc     binary     0.630    50 0.0159  Preprocessor1_Model1</code></pre>
</div>
</div>
<p>In this case, our linear model has slightly outperformed its nonparametric counterpart. This is not a huge surprise with such a small dataset. Because model performance is so similar, I recommend using the linear model for a few reasons:</p>
<ul>
<li>It is much faster to retrain and deploy.</li>
<li>Interpretable coefficients make it easier to understand which factors are most important.</li>
<li>It is less likely to overfit on retraining.</li>
</ul>
<p>However, it would be worth looking at more ensemble models if we obtained a larger dataset. In general, these models perform better as they obtain more data, and it would allow us to incorporate variables that might be useful like the text component from the “story” variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(log_fit, <span class="st">'trained_predictive_logit_model.rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-aways" class="level1">
<h1>Take-Aways</h1>
<p>It seems clear that data breaches are becoming more common as time goes on. While no breach is good, those that generate large amounts of negative publicity for an organization can be particularly harmful. Based on the data we have examined today, I would make the following recommendations:</p>
<ol type="1">
<li>Re-examine our current cybersecurity budget. Are we sufficiently staffed to prevent hacks and prevent exploits?</li>
<li>Ensure that internal employees and contractors are unable to remove data from their workspaces.</li>
<li>Use the predictive model to assess the potential risk of an “interesting” breach based on likely scenarios. Use this information to assess our highest risk scenarios and prioritize their mitigation.</li>
</ol>
<p>Implementing these recommendations is likely to reduce our risk of breach in general, and our risk of a PR nightmare caused by a breach in particular.</p>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<p>The next few items contain code used for checking the validity of my inferential model. It will not be of interest to business users, but is crucial for determining the validity of the inference made above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check residuals</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>data_res <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">predicted.probabilities =</span> <span class="fu">fitted</span>(interestingModel_inference),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">standardized.residuals =</span> <span class="fu">rstandard</span>(interestingModel_inference),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">studentized.residuals =</span> <span class="fu">rstudent</span>(interestingModel_inference),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dfbeta_int =</span> <span class="fu">dfbeta</span>(interestingModel_inference)[<span class="dv">1</span>],</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dfbeta_pred1 =</span> <span class="fu">dfbeta</span>(interestingModel_inference)[<span class="dv">2</span>],</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dffit =</span> <span class="fu">dffits</span>(interestingModel_inference),</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">leverage =</span> <span class="fu">hatvalues</span>(interestingModel_inference))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that no more than 5% of standardized/studentized residuals have</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="co"># an absolute value greater than 1.96 and no more than 1% have an</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co"># absolute value greater than 2.58.</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>data_res <span class="sc">|&gt;</span> </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stan_gt_196 =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(standardized.residuals) <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">stud_gt_196 =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(standardized.residuals) <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">stan_gt_258 =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(standardized.residuals) <span class="sc">&gt;</span> <span class="fl">2.58</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">stud_gt_258 =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(standardized.residuals) <span class="sc">&gt;</span> <span class="fl">2.58</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stan_gt_196)) <span class="sc">|&gt;</span> </span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">stan_196_prop =</span> <span class="fu">round</span>(<span class="fu">mean</span>(stan_gt_196),<span class="dv">2</span>),</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">stud_196_prop =</span> <span class="fu">round</span>(<span class="fu">mean</span>(stud_gt_196),<span class="dv">2</span>),</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">stan_258_prop =</span> <span class="fu">round</span>(<span class="fu">mean</span>(stan_gt_258),<span class="dv">2</span>),</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">stud_258_prop =</span> <span class="fu">round</span>(<span class="fu">mean</span>(stud_gt_258),<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  stan_196_prop stud_196_prop stan_258_prop stud_258_prop
          &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1          0.05          0.05             0             0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that dfbeta is less than 1 for the intercept and the predictor of</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># interest</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>data_res <span class="sc">|&gt;</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dfbeta_int, dfbeta_pred1) <span class="sc">|&gt;</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  dfbeta_int dfbeta_pred1
       &lt;dbl&gt;        &lt;dbl&gt;
1    0.00439      0.00649</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that we have at least 10 events per predictor</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">sum</span>(<span class="fu">ifelse</span>(interesting_story <span class="sc">==</span> <span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(interestingModel_inference)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>events_per_predictor <span class="ot">&lt;-</span> events <span class="sc">/</span> predictors</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(events_per_predictor) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.33333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot leverage values - no more than 10% should exceed threshold</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_res, <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_res), <span class="at">y =</span> leverage)) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span> <span class="sc">*</span> (predictors <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/model_checking-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check assumptions</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that no VIF is over 10</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(interestingModel_inference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     GVIF Df GVIF^(1/(2*Df))
finance_telecom  1.048596  1        1.024010
data_sensitivity 1.049218  4        1.006024
records_lost     1.000797  1        1.000399</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the linearity of the logit</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The log_records_lost variable should have a p-value greater than 0.05.</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>linearity_data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(records_lost)) <span class="sc">|&gt;</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">log_records_lost =</span> <span class="fu">log</span>(records_lost)<span class="sc">*</span>records_lost)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>linearityTestModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(interesting_story <span class="sc">~</span> sector <span class="sc">+</span> method <span class="sc">+</span> data_sensitivity <span class="sc">+</span> records_lost <span class="sc">+</span> <span class="fu">as.factor</span>(year) <span class="sc">+</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>                            log_records_lost,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> linearity_data,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linearityTestModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = interesting_story ~ sector + method + data_sensitivity + 
    records_lost + as.factor(year) + log_records_lost, family = "binomial", 
    data = linearity_data)

Coefficients:
                             Estimate        Std. Error z value Pr(&gt;|z|)    
(Intercept)          -18.995711635302 3956.180535360993  -0.005 0.996169    
sectorapp            -13.907262661079  819.028570508247  -0.017 0.986452    
sectorenergy         -13.964120217525 2117.039064072397  -0.007 0.994737    
sectorfinancial        2.406759331805    1.263821955904   1.904 0.056865 .  
sectorgaming           0.814587215102    1.649677267861   0.494 0.621457    
sectorgovernment       1.249835823085    1.251759183835   0.998 0.318055    
sectorhealthcare       1.829901208572    1.284401097927   1.425 0.154241    
sectormedia            2.363364499900    1.728750949494   1.367 0.171596    
sectormilitary         1.989807516216    2.207514248820   0.901 0.367387    
sectorretail           1.936077655559    1.296452271304   1.493 0.135341    
sectortech             1.709097906329    1.619600754114   1.055 0.291307    
sectortelecoms         2.737362148973    1.379497681160   1.984 0.047220 *  
sectortransport        2.660225063051    1.502888820613   1.770 0.076715 .  
sectorweb              1.472729602164    1.260954830265   1.168 0.242828    
methodinside job      -1.338482760160    0.877533738039  -1.525 0.127190    
methodlost device      0.338211621303    0.581553102448   0.582 0.560859    
methodoops!            1.863754330417    0.663366285527   2.810 0.004961 ** 
methodpoor security    0.488662565847    0.681371503385   0.717 0.473266    
data_sensitivity2      0.355361068052    0.502558224843   0.707 0.479502    
data_sensitivity3      0.242985136091    0.610461549566   0.398 0.690604    
data_sensitivity4      0.286038757131    0.706420100787   0.405 0.685541    
data_sensitivity5      2.807889698416    0.751573929185   3.736 0.000187 ***
records_lost           0.000000170915    0.000000103194   1.656 0.097670 .  
as.factor(year)2005   16.440793928955 3956.180621428867   0.004 0.996684    
as.factor(year)2006   16.372462001179 3956.180478662965   0.004 0.996698    
as.factor(year)2007   15.209996213328 3956.180440605814   0.004 0.996932    
as.factor(year)2008   15.899741386718 3956.180390337018   0.004 0.996793    
as.factor(year)2009   18.247870896014 3956.180471950142   0.005 0.996320    
as.factor(year)2010   15.297112123155 3956.180420527191   0.004 0.996915    
as.factor(year)2011   15.106178686733 3956.180400836009   0.004 0.996953    
as.factor(year)2012   14.723973502303 3956.180416390714   0.004 0.997030    
as.factor(year)2013   16.016967330959 3956.180351385114   0.004 0.996770    
as.factor(year)2014   15.458293390925 3956.180394274088   0.004 0.996882    
as.factor(year)2015   13.855487451481 3956.180438314338   0.004 0.997206    
as.factor(year)2016   12.329680389940 3956.180519908041   0.003 0.997513    
as.factor(year)2017   14.471784619003 3956.180451435710   0.004 0.997081    
as.factor(year)2018   13.012758130729 3956.180438619536   0.003 0.997376    
as.factor(year)2019   14.530581701659 3956.180393106396   0.004 0.997069    
log_records_lost      -0.000000008553    0.000000005368  -1.593 0.111072    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 338.48  on 335  degrees of freedom
Residual deviance: 236.57  on 297  degrees of freedom
AIC: 314.57

Number of Fisher Scoring iterations: 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions against actuals</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>data_res <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> interesting_story, <span class="at">y =</span> predicted.probabilities)) <span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Predictions vs. Actuals"</span>, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Interesting Story"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">'bold'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Data-Mining-Demo_files/figure-html/model_checking-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>